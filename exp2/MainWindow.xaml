<Window x:Class="MessManagementSystem.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Mess Management System" Height="800" Width="1200">
    
    <Window.Resources>
        <!-- Style for rounded TabItem -->
        <Style x:Key="RoundedTabItemStyle" TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border CornerRadius="10" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1" Margin="2">
                            <ContentPresenter ContentSource="Header" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="10"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="LightGray"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <StackPanel DockPanel.Dock="Left" Width="auto " Background="White">
            <!-- Logo and Text at the top -->
            <StackPanel Orientation="Horizontal" Margin="10">
                <TextBlock Text="vEc"
Foreground="#CC0000"
FontSize="32"
FontFamily="TESLA"
FontWeight="Normal"
TextWrapping="Wrap"
VerticalAlignment="Center"
HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- TabControl with rounded TabItems -->

            <TabControl x:Name="MainTabControl" TabStripPlacement="Left" Background="#F5F7FA" Height="700">
                <TabItem Header="Dashboard" Style="{StaticResource RoundedTabItemStyle}">
                    <StackPanel Margin="10">
                        <TextBlock Text="Dashboard" FontFamily="inter" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>
                        <TextBlock Text="Enter Roll Number:" Margin="0,10,0,5"/>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="330" HorizontalAlignment="Left" >
                                <TextBox x:Name="RollNumberTextBox" Width="auto" Height="auto" KeyDown="RollNumberTextBox_KeyDown" TextChanged="RollNumberTextBox_TextChanged" BorderBrush="Transparent" IsEnabled="True" />
                            </Border>
                            </StackPanel>


                        <TextBlock Text="Entries" FontWeight="Bold" FontSize="14" Margin="0,20,0,10"/>
                        <Grid>
                            
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Border Grid.Column="0" CornerRadius="25" Background="White" Margin="5" Padding="10" Width="auto" HorizontalAlignment="Stretch" Height="600" >
                             
                                <ListView x:Name="DashboardPastEntriesListView" BorderBrush="Transparent" SelectionChanged="DashboardPastEntriesListView_SelectionChanged">
                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn Header="S.No" DisplayMemberBinding="{Binding SerialNumber}" Width="50"/>

                                            <GridViewColumn Header="Image" Width="50">

                                                <GridViewColumn.CellTemplate>

                                                    <DataTemplate>

                                                        <Image Source="{Binding ImageSource}" Width="40" Height="40"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Roll Number" DisplayMemberBinding="{Binding RollNumber}" Width="75"/>
                                            <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="100"/>
                                            <GridViewColumn Header="Fathers NA" DisplayMemberBinding="{Binding Amount}" Width="50"/>
                                            <GridViewColumn Header="Rate" DisplayMemberBinding="{Binding Rate}" Width="50"/>
                                            <GridViewColumn Header="Meal" DisplayMemberBinding="{Binding Meal}" Width="50"/>
                                            <GridViewColumn Header="Date" DisplayMemberBinding="{Binding Date}" Width="75"/>
                                            <GridViewColumn Header="Time" DisplayMemberBinding="{Binding Time}" Width="50"/>
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                            </Border>



                            <Border Grid.Column="1" CornerRadius="25" Background="White" Margin="5" Padding="10" Width="auto" HorizontalAlignment="Stretch" Height="600" >
                                <ListView x:Name="ExtraMealsPastEntriesListView" Height="600" BorderBrush="Transparent" Background="Transparent">

                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn Header="S.No" DisplayMemberBinding="{Binding SerialNumber}" Width="50"/>

                                            <GridViewColumn Header="Image" Width="50">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Image Source="{Binding ImageSource}" Width="40" Height="40"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Roll Number" DisplayMemberBinding="{Binding RollNumber}" Width="75"/>
                                            <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="100"/>
                                            <GridViewColumn Header="Amount" DisplayMemberBinding="{Binding Amount}" Width="50"/>
                                            <GridViewColumn Header="Rate" DisplayMemberBinding="{Binding Rate}" Width="50"/>
                                            <GridViewColumn Header="Meal" DisplayMemberBinding="{Binding Meal}" Width="50"/>
                                            <GridViewColumn Header="Date" DisplayMemberBinding="{Binding Date}" Width="75"/>
                                            <GridViewColumn Header="Time" DisplayMemberBinding="{Binding Time}" Width="50"/>
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                            </Border>
                        </Grid>

                        <TextBlock x:Name="StudentDetailsTextBlock" FontSize="14" Margin="0,10,0,10"/>
                        <Image x:Name="StudentImage" Width="84" Height="77" Margin="0,10,0,10"/>
                        <TextBlock x:Name="RateDetailsTextBlock" FontSize="14" Margin="0,10,0,10"/>

                        <TextBlock Text="Rates" FontWeight="Bold" FontSize="14"/>
                        <Border CornerRadius="25" Background=" White" Margin="5" Padding="10" Grid.Column="0" Width="1070" HorizontalAlignment="Left" Visibility="Hidden">
                            <ListBox x:Name="RatesListBox" Height="248" BorderBrush="Transparent" Background="Transparent"/>
                        </Border>
                    </StackPanel>
                </TabItem>

                
                
                
                
                



                <TabItem Header="Snacks" Style="{StaticResource RoundedTabItemStyle}">
                     <Grid>
                    <StackPanel>
                            <TextBlock Text="Snacks" FontFamily="inter" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>

                            <TextBlock Text="Items available:" Margin="0,10,0,5"/>

                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="auto" HorizontalAlignment="Left">

                                <ListBox x:Name="ExtraMealsListBox" SelectionChanged="ExtraMealsListBox_SelectionChanged" Focusable="False" BorderBrush="Transparent" Background="Transparent"/>
                            </Border>
                            <TextBlock Text="Enter Roll Number:" Margin="0,10,0,5"/>
                        

                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Left">
                                <TextBox x:Name="RollNumberTextBoxExtraMeals" Text="" BorderBrush="Transparent" Background="Transparent" IsEnabled="True" />
                                </Border>

                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="40" HorizontalAlignment="Right">
                                <Button x:Name="LockButton" Content="🔓" Click="LockButton_Click" Width="30" HorizontalAlignment="Center" Background="Transparent" BorderBrush="Transparent"/>
                            </Border>

                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="200" HorizontalAlignment="Left">
                                <Button Content="Save Extra Meal" Click="SaveExtraMealButton_Click" BorderBrush="Transparent" Background="Transparent" />
                                    </Border>

                                 
                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="auto" HorizontalAlignment="Left">
                                <ListView x:Name="PastEntriesListView" Height="600" Margin="10" BorderBrush="Transparent" Background="Transparent">
                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn Header="S.No" DisplayMemberBinding="{Binding SerialNumber}" Width="50"/>

                                            <GridViewColumn Header="Image" Width="50">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Image Source="{Binding ImageSource}" Width="40" Height="40"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Roll Number" DisplayMemberBinding="{Binding RollNumber}" Width="100"/>
                                            <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="150"/>
                                            <GridViewColumn Header="Amount" DisplayMemberBinding="{Binding Amount}" Width="75"/>
                                            <GridViewColumn Header="Rate" DisplayMemberBinding="{Binding Rate}" Width="75"/>
                                            <GridViewColumn Header="Meal" DisplayMemberBinding="{Binding Meal}" Width="100"/>
                                            <GridViewColumn Header="Date" DisplayMemberBinding="{Binding Date}" Width="100"/>
                                            <GridViewColumn Header="Time" DisplayMemberBinding="{Binding Time}" Width="75"/>
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                                        </Border>

                        </StackPanel>
                    </Grid>

                    </TabItem>


                




                <TabItem Header="Update Data" Style="{StaticResource RoundedTabItemStyle}">
                    <Grid>
                        <StackPanel Margin="10">
                            <TextBlock Text="Update Data" FontFamily="inter" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>


                            <TextBlock Text="Upload Excel File URL:" FontWeight="Bold" HorizontalAlignment="Center"/>
                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="auto" HorizontalAlignment="Center" Height="57">
                                <TextBox Name="UploadedSpreadsheetPath" IsReadOnly="True" Margin="0,5,0,15" Width="1070" BorderBrush="Transparent" Background="Transparent" />
                            </Border>

                            <Border CornerRadius="25" Background="LightGray" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Center" Height="55">
                                <Button Content="Browse..." Click="BrowseSpreadsheet_Click" Margin="0,5,0,15" FontFamily="inter" BorderBrush="Transparent" Background="Transparent"/>
                            </Border>

                            <Border CornerRadius="25" Background="LightGray" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Center" Height="59">
                                <Button Content="Upload to google sheeets" Click="UploadFiles_Click" Margin="0,5,0,15" FontFamily="inter" BorderBrush="Transparent" Background="Transparent" />
                            </Border>

                            <Border CornerRadius="25" Background="LightGray" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Center" Height="59">
                                <Button Content="Check for new entries from googel spreadsheets" Click="ManualSyncButton_Click" Margin="0,5,0,15" FontFamily="inter" BorderBrush="Transparent" Background="Transparent" />
                            </Border>
                            <TextBlock Name="UploadStatusLabel" Foreground="Red" Margin="0,10,0,0" VerticalAlignment="Center"/>


                            <TextBlock Text="Google Drive Folder URL:" FontWeight="Bold" HorizontalAlignment="Center" />

                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="1053" HorizontalAlignment="Center" Height="55">

                                <TextBox Name="FolderUrl" Margin="0,5,0,15" BorderBrush="Transparent"/>
                            </Border>
                            <TextBlock Name="StatusLabel" Foreground="Red" Margin="0,10,0,0" />

                            <Border CornerRadius="25" Background="LightGray" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Center" Height="64">

                                <Button Content="Download Pics" Click="FetchAndSave_Click" Margin="0,5,0,15"  Background="Transparent" BorderBrush="Transparent"/>
                            </Border>

                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">

                             <Label Content="Diet Rate:"/>
                                
                                <TextBox x:Name="ColumnJValue"  Width="50" Text="26.5" BorderBrush="Gray" VerticalAlignment="Center"/>
                                    
                            <Label Content="Electricity Bill:"/>
                                <TextBox x:Name="ColumnMValue" Width="50" Text="86" BorderBrush="Gray" VerticalAlignment="Center"/>
                                
                            <Label Content="Fine:"/>
                                <TextBox x:Name="ColumnNValue" Width="50" Text="10" BorderBrush="Gray" VerticalAlignment="Center"/>
                                
                            <Label Content="Advance Amount:"/>
                                <TextBox x:Name="ColumnPValue" Width="50" Text="20000" BorderBrush="Gray" VerticalAlignment="Center"/>

                            </StackPanel>
                            <Border CornerRadius="25" Background="LightGray" Margin="5" Padding="10" Grid.Column="0" Width="200" HorizontalAlignment="Center">
                                <Button Grid.Row="1" Content="Apply Formulas" Click="ApplyFormulas_Click" Margin="10" Background="Transparent" BorderBrush="Transparent"/>
                            </Border>


                                    <TextBox Grid.Row="2" x:Name="LogTextBox" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" Margin="10" BorderBrush="Transparent" Background="Transparent"/>

                        </StackPanel>
                    </Grid>
                </TabItem>

                <TabItem Header="Upload Files" Style="{StaticResource RoundedTabItemStyle}">
                    <StackPanel Margin="10">
                        <TextBlock Text="Upload Excel Files" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>

                        <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Left">
                            <Button Content="Upload Data Excel" Width="200" Click="UploadExcelButton_Click" Margin="0,0,0,10" FontFamily="inter" BorderBrush="Transparent" Background="Transparent" />
                        </Border>
                        <TextBlock x:Name="ExcelStatusTextBlock" Text="" Margin="0,0,0,20"/>

                        <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Left">
                            <Button Content="Upload Rates Excel" Width="200" Click="UploadRatesExcelButton_Click" Margin="0,0,0,10" FontFamily="inter" BorderBrush="Transparent" Background="Transparent" />
                        </Border>
                        <TextBlock x:Name="RatesExcelStatusTextBlock" Text="" Margin="0,0,0,20"/>

                        <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Left">
                            <Button Content="Upload Images" Width="200" Click="UploadImagesButton_Click" Margin="0,0,0,10" FontFamily="inter" BorderBrush="Transparent" Background="Transparent" />
                        </Border>
                        <TextBlock x:Name="ImagesStatusTextBlock" Text="" Margin="0,0,0,20"/>
                        <TextBlock  Text="" Margin="0,0,0,20"/>


                        <Border CornerRadius="25" Background="LightGray" Margin="5" Padding="10" Grid.Column="0" Width="300" HorizontalAlignment="Left">
                            <Button Content="Process Data"  Width="200" Click="ProcessDataButton_Click" Margin="0,0,0,10" FontFamily="inter"  BorderBrush="Transparent" Background="Transparent" />
                        </Border>
                        <ListBox x:Name="DataListBox" Height="400" Margin="0,20,0,0" Visibility="Hidden"/>

                    </StackPanel>
                </TabItem>'

                <TabItem Header="Extra Meals" Style="{StaticResource RoundedTabItemStyle}" Visibility="Hidden" >
                    <Grid>
                        <StackPanel>
                            <TextBlock Text="Extra Meals" FontFamily="inter" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>

                            <TextBlock Text="Enter Roll Number:" Margin="0,10,0,5"/>


                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="330" HorizontalAlignment="Left" >
                                <TextBox x:Name="ExtraMealsRollNumberTextBox" Width="200" HorizontalAlignment="Left" Background="Transparent" BorderBrush="Transparent" TextChanged="ExtraMealsRollNumberTextBox_TextChanged"/>

                            </Border>


                            <TextBlock Text="Entries" FontWeight="Bold" Margin="0,20,0,5"/>





                            <TextBlock Text="Default Extra Meal Rates" FontWeight="Bold" Margin="0,20,0,5"/>
                            <Border CornerRadius="25" Background="White" Margin="5" Padding="10" Grid.Column="0" Width="661" HorizontalAlignment="Left" Visibility="Hidden" >


                                <ListBox x:Name="ExtraMealsDefaultRatesListBox" Height="200" BorderBrush="Transparent" Background="Transparent"/>
                            </Border>
                        </StackPanel>

                    </Grid>
                </TabItem>


            </TabControl>
        </StackPanel>
    </DockPanel>
</Window>
